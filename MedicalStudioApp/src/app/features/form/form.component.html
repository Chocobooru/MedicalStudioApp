<div class="divvone">
  <h2>New Appointment</h2>
  <form [formGroup]="formValue" (ngSubmit)="manageSubmit()">
    <div formArrayName="formArray" class="d-flex around">
      <div [formGroup]="formValuePatient" class="d-flex direction-column">
        <div class="d-flex">
          <mat-form-field appearance="standard">
            <mat-label>Name</mat-label>
            <input matInput formControlName="name">
            <mat-error *ngIf="formValuePatient.get('name')?.hasError('required')">
              Name is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="standard">
            <mat-label>Surname</mat-label>
            <input matInput formControlName="surname">
            <mat-error *ngIf="formValuePatient.get('surname')?.hasError('required')">
              Surname is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="standard" class="mini">
            <mat-label>age</mat-label>
            <input matInput formControlName="age" type="number">
            <mat-error *ngIf="formValuePatient.get('age')?.hasError('required')">
              Age is required
            </mat-error>
          </mat-form-field>
        </div>
        <mat-radio-group formControlName="gender">
          <mat-radio-button value="M">Male</mat-radio-button>
          <mat-radio-button value="F">Female</mat-radio-button>
          <mat-radio-button value="NB">Non-binary</mat-radio-button>
        </mat-radio-group>
        <div>
          <mat-form-field appearance="standard">
            <mat-label>Fiscal Code</mat-label>
            <input matInput formControlName="fiscalCode">
            <mat-error *ngIf="formValuePatient.get('fiscalCode')?.hasError('required')">
              Fiscal Code is required
            </mat-error>
            <mat-error *ngIf="formValuePatient.get('fiscalCode')?.hasError('pattern')">
              Fiscal Code is not valid (it must be 6 capital letters and 2 numbers)
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="standard">
            <mat-label>Phone</mat-label>
            <input matInput formControlName="phone" type="phone">
            <mat-error *ngIf="formValuePatient.get('phone')?.hasError('required')">
              Phone is required
            </mat-error>
            <mat-error *ngIf="formValuePatient.get('phone')?.hasError('pattern')">
              Phone is not valid
            </mat-error>
          </mat-form-field>
        </div>
        <mat-form-field appearance="standard">
          <mat-label>Address</mat-label>
          <input matInput formControlName="address">
          <mat-error *ngIf="formValuePatient.get('address')?.hasError('required')">
            Address is required
          </mat-error>
        </mat-form-field>
        <mat-form-field appearance="standard">
          <mat-label>E-mail</mat-label>
          <input matInput formControlName="email" type="email">
          <mat-error *ngIf="formValuePatient.get('email')?.hasError('required')">
            E-mail is required
          </mat-error>
          <mat-error *ngIf="formValuePatient.get('email')?.hasError('email')">
            Email is not valid
          </mat-error>
        </mat-form-field>
        <div>
          <button (click)="postPatient()" mat-flat-button color="primary" [disabled]="!formValuePatient.valid">
            ADD TO CONTACTS
          </button>
        </div>
      </div>
      <div [formGroup]="formValueAppointment" class="d-flex">
        <div class="d-flex direction-column">
          <div class="d-flex">
            <mat-form-field appearance="standard">
              <mat-label>Date</mat-label>
              <input matInput placeholder="2022-05-11" type="date" id="hiringDate"
                     name="hiringDate" formControlName="date">
              <mat-error *ngIf="formValueAppointment.get('date')?.hasError('required')">
                Date is required
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="standard" class="mini">
              <mat-label>Start:</mat-label>
              <input matInput formControlName="startHour" type="time">
              <mat-error *ngIf="formValueAppointment.get('startHour')?.hasError('required')">
                Start is required
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="standard" class="mini">
              <mat-label>End:</mat-label>
              <input matInput formControlName="endHour" type="time">
              <mat-error *ngIf="formValueAppointment.get('endHour')?.hasError('required')">
                End is required
              </mat-error>
            </mat-form-field>
          </div>
          <mat-form-field appearance="standard">
            <mat-label>Select service</mat-label>
            <mat-select formControlName="medicalService">
              <mat-option *ngFor="let service of medicalServiceData" value="{{service.name}}">
                {{service.name}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="formValueAppointment.get('medicalService')?.hasError('required')">
              Service is required
            </mat-error>
          </mat-form-field>
          <mat-form-field appearance="standard">
            <mat-label>Select place</mat-label>
            <mat-select formControlName="place">
              <mat-option *ngFor="let place of placeData" value="{{place.name}}">
                {{place.name}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="formValueAppointment.get('place')?.hasError('required')">
              Place is required
            </mat-error>
          </mat-form-field>
        </div>
        <div class="d-flex direction-column">
          <div class="d-flex">
            <div>
              <mat-form-field class="example-full-width medium" appearance="standard">
                <mat-label>Leave a note</mat-label>
                <textarea matInput placeholder="Ex. It hurts when..." formControlName="notes"></textarea>
              </mat-form-field>
            </div>
          </div>
          <div>
            <button mat-flat-button color="primary" [routerLink]="['/appointments']">
              CANCEL
            </button>
            <button mat-flat-button color="primary" (click)="postAppointment()"
                    [disabled]="!formValue.valid">
              CONFIRM
            </button>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
